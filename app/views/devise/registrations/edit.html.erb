<div class="container my-5">
  <h2 class="mb-4">Editar Usuário</h2>

  <%= form_for [:admin, @user], html: { multipart: true, class: "needs-validation" } do |f| %>
    <div class="row">
      <div class="col-md-6">
        <div class="mb-3">
          <%= f.label :name, "Nome", class: "form-label" %>
          <%= f.text_field :name, class: "form-control" %>
        </div>

        <div class="mb-3">
          <%= f.label :email, "Email", class: "form-label" %>
          <%= f.email_field :email, class: "form-control" %>
        </div>

        <% if current_user.admin? %>
          <div class="mb-3">
            <%= f.label :role, "Tipo de Usuário", class: "form-label" %>
            <%= f.select :role, User.roles.keys.map { |role| [role.titleize, role] }, {}, class: "form-select" %>
          </div>
        <% end %>

      <div class="col-md-6">
        <div class="mb-3">
          <%= f.label :photo, "Foto de Perfil", class: "form-label" %>

          <% if @user.photo.attached? %>
            <div class="mb-3">
              <%= image_tag @user.photo.variant(resize_to_limit: [150, 150]), class: "rounded-circle border mb-2" %>
              <div class="form-check">
                <%= f.check_box :remove_photo, class: "form-check-input" %>
                <%= f.label :remove_photo, "Remover foto atual", class: "form-check-label" %>
              </div>
            </div>
          <% end %>

          <%= f.file_field :photo, class: "form-control" %>
          <small class="text-muted">Formatos: JPG, PNG (Máx. 5MB)</small>
        </div>

        <div class="mb-3">
          <%= f.label :password, "Nova Senha", class: "form-label" %>
          <small class="text-muted">(Deixe em branco para não alterar)</small>
          <%= f.password_field :password, class: "form-control" %>
        </div>

        <div class="mb-3">
          <%= f.label :password_confirmation, "Confirmação da Senha", class: "form-label" %>
          <%= f.password_field :password_confirmation, class: "form-control" %>
        </div>
      </div>
    </div>

    <div class="d-flex justify-content-between mt-4">
      <%= link_to "Cancelar", admin_users_path, class: "btn btn-secondary" %>
      <%= f.submit "Atualizar Usuário", class: "btn btn-primary" %>
    </div>
  <% end %>
</div>
