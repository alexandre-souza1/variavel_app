<div class="container mt-5">

  <!-- Card Resumo -->
  <div class="card shadow-sm rounded mb-4">
    <div class="card-body">
      <div class="row align-items-center">
        <div class="col-md-6">
          <h2 class="mb-1"><i class="bi bi-fuel-pump"></i> Consumo de Combustível</h2>
          <p class="text-muted mb-0">
            Total de registros: <%= @fuel_consumptions.size %> <br>
            Média geral (Km/L): <%= @fuel_consumptions.average(:km_per_liter).to_f.round(2) %> <br>
            Motoristas dentro da meta: <%= @fuel_consumptions.select { |fc| fc.km_per_liter >= fc.km_per_liter_goal }.count %> <br>
            Motoristas abaixo da meta: <%= @fuel_consumptions.select { |fc| fc.km_per_liter < fc.km_per_liter_goal }.count %>
          </p>
        </div>
        <div class="col-md-6 text-md-end">
          <%= link_to "Importar CSV", new_fuel_consumption_path, class: "btn btn-primary me-2" %>
        </div>
      </div>
    </div>
  </div>

  <!-- Tabela de histórico -->
  <div class="card shadow-sm">
    <div class="card-body">
      <table class="table table-hover align-middle">
        <thead class="table-light">
          <tr>
            <th>Motorista</th>
            <th>Média / Meta (Km/L)</th>
            <th>Período</th>
            <th>Data Importação</th>
          </tr>
        </thead>
        <tbody>
          <% @fuel_consumptions.each do |fc| %>
            <tr>
              <td><%= fc.driver_name %></td>
              <td class="<%= fc.km_per_liter >= fc.km_per_liter_goal ? 'table-success' : 'table-danger' %>">
                <strong>Média:</strong> <%= fc.km_per_liter %> <br>
                <strong>Meta:</strong> <%= fc.km_per_liter_goal %>
                <% if fc.km_per_liter >= fc.km_per_liter_goal %>
                  ✅
                <% else %>
                  ❌
                <% end %>
              </td>
              <td><%= fc.period %></td>
              <td><%= l(fc.created_at, format: :short) %></td>
            </tr>
          <% end %>
        </tbody>
      </table>
      <%= link_to "Voltar", root_path, class: "btn btn-primary shadow-sm p-3 w-100 mt-2" %>
    </div>
  </div>
</div>
